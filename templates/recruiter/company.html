{% extends 'base.html' %}

{% block title %}Recruiter Dashboard{% endblock %}

{% block content %}
    <!-- Companies Section -->
    <section id="companies">
        <h2>My Companies</h2>
        <div class="container" id="companiesContainer">
            <div class="company">
                <div>
                    <span>username:</span><span class="value">{{ company.username }}</span>
                </div>
                <div>
                    <span>companyName:</span><span class="value">{{ company.companyName }}</span>
                </div>
                <div>
                    <span>companyPhone:</span><span class="value">{{ company.companyPhone }}</span>
                </div>
                <div>
                    <span>companyAddress:</span><span class="value">{{ company.companyAddress }}</span>
                </div>
                <div>
                    <span>companyDescription:</span><span class="value">{{ company.companyDescription }}</span>
                </div>
                <div>
                    <span>employeeSize:</span><span class="value">{{ company.employeeSize }}</span>
                </div>
            </div>
        </div>
    </section>
    <section id="recruiters">
        <h2>Company Recruiters</h2>
        <div class="recruiters" id="recruiterContainer">
            {% for rcs in recruiters %}
                <div class="recruiter">
                    <div class="group">

                        <div>
                            <span>Username: </span><span class="value">{{ rcs["username"] }}</span>
                        </div>
                        <div>
                            <span>Role: </span><span class="value">{{ rcs["role"] }}</span>
                        </div>
                        <div>
                            <span>Recuiter Email: </span><span class="value">{{ rcs["email"] }}</span>
                        </div>
                    </div>
                    <div class="buttons">
                        <a href="/recruiter/profile/{{ rcs['username'] }}">View Profile</a>
                        {% if rc['role'] == 'admin' %}
                            {% if rcs['role'] == 'recruiter' %}
                                <button onclick="removeRecruiter({{ rcs['id'] }})">Remove</button>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
            </div>
        </div>
    </section>

    <!-- Job Posts Section -->
    <section id="posts">
        <h2>My Job Posts</h2>
        <div class="container" id="postsContainer">
            {% for post in posts %}
                <a href="/recruiter/post/{{ post.postId }}">
                    <div class="post">
                        <h3>{{ post.title }}</h3>
                        <p>{{ post.description }}</p>
                    </div>
                </a>
            {% endfor %}
        </div>
    </section>

    <script>
        function logout() {
            fetch("/api/recruiter/logout", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRF-TOKEN": getCookie("csrf_access_token")
                },
                credentials: "include"
            })
            .then(response => response.json())
            .then(data => {
                if (data.message) {
                    alert('Logged out successfully!');
                    window.location.href = '/login';
                } else {
                    alert('Logout failed');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Logout failed');
            });
        }
    </script>

{% endblock %}